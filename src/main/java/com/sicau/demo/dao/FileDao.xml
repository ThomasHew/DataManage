<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sicau.demo.dao.FileDao">
    <insert id="uploadFile" useGeneratedKeys="true" parameterType="com.sicau.demo.entity.Files">
        INSERT INTO `files`(
        `group_name`,
        `ture_file_name`,
        `upload_ip`,
        `user_name`,
        `upload_time`,
        `file_describe`,
        `file_view`,
        `customize_file_name`
        )
        values (
        #{groupName},
        #{tureFileName},
        #{uploadIp},
        #{userName},
        #{uploadTime},
        #{fileDescription},
        #{fileView},
        #{customizeFileName},
        );
    </insert>

    <!-- //获得总记录数
   Integer getTotalFilesCount();-->
    <select id="getTotalFilesCount" resultType="int">
        select count(*) from files
        <where>
            <if test="tureFileName!=null and tureFileName!=''">

                and ture_file_name LIKE '%${tureFileName}%'
            </if>
            <if test="groupName!=null and groupName!=''">
                AND group_name =#{groupName}
            </if>

        </where>

    </select>
    <!-- //按条件分页查询

     List<FileList> getFileListByQueryBean(QueryBean queryBean);-->
    <select id="getFileListByQueryBean" resultType="com.sicau.demo.entity.FileList">
        SELECT
        `group_name`,
        `ture_file_name`,
        `upload_ip`,
        `user_name`,
        `upload_time`,
        `update_time`,
        `file_view`
        FROM
        `datamanage`.`files`
        <where>
            <if test="tureFileName!=null and tureFileName!=''">

                and ture_file_name LIKE '%${tureFileName}%'
            </if>
            <if test="groupName!=null and groupName!=''">
                and group_name=#{groupName}
            </if>

        </where>
        order by 'upload_time' DESC
        LIMIT #{currentRow}, #{pageSize};
    </select>
</mapper>